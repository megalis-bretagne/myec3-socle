<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html t:type="layout" xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd" xmlns:p="tapestry:parameter">
    <div id="main-content">
        <h2>${message:title}</h2>
        
        <t:if test="successMessage">
            <p class="success">${message:successMessage}</p>
        </t:if>
		
        <t:if test="errorMessage">
            <p class="error">${errorMessage}</p>
        </t:if>

        <t:if test="multipleAccount">
        	<p class="info">${message:multi-no-activation-profile-error}</p>
        </t:if>
        
        <t:form t:id="regenerate_password_form">
        	<t:errors/>
    		<p class="mandatory">
        		${message:mandatory-label}
        	</p>
            <fieldset>
            	<legend>${message:legend-label}</legend>
            	<p class="instructions">${message:instructions-label}</p>
				
	        	<p>
	                <t:label for="username">${message:username-label} *:</t:label>
	        		<t:textfield t:id="username" t:value="username" t:validate="required,maxlength=255,"/>
	        		<a href="#" title="${message:username-help-label}">
	        			<img src="${context:static/images/pic_help.png}" class="picHelp" alt="${message:username-help-label}"/>
	        		</a>
				</p>
				
				<t:if negate="true" test="successMessage">
					<t:if test="foundAccounts">			
					<table>
						<caption>${message:instructions-multiple-accounts-label}</caption>
						<tr>
							<th> </th><th>${message:profileType-label}</th><th>${message:organism-label}</th><th>${message:lastname-label}</th><th>${message:email-label}</th><th>${message:username-label}</th><th>${message:enabled-label}</th>
						</tr>
						
						<t:if test="availableProfiles">
								<t:loop source="availableProfiles"  encoder="profileEncoder" value="profileLoop">
									<tr>
										<p class="instructions">
											
											<td><t:checkbox t:id="id" t:value="selected" t:disabled="canChangePassword"/></td>
											<td>${profileLoop?.function}</td><td>${profileLoop?.label}</td><td>${profileLoop?.user?.lastname}</td><td>${profileLoop?.email}</td><td>${profileLoop?.user?.username}</td>
											<t:if test="isProfileEnabled">
												<td><font color="green">${message:yes-label}</font></td>
												<p:else>
													<td><font color="red">${message:no-label}</font></td>
												</p:else>
											</t:if>
										</p>
									</tr>
								</t:loop>
						</t:if>		
						
						<t:if test="availableProjectAccounts">
							<t:loop source="availableProjectAccounts"  encoder="projectAccountEncoder" value="projectAccountLoop">
		        				<tr>
	                				<p class="instructions">
	                					<t:if test="isProjectEnabled">
												<td><t:checkbox t:id="idpp" t:value="selectedpp"/></td>
												<td>${projectAccountLoop?.name}</td><td>${projectAccountLoop?.label}</td><td>${projectAccountLoop?.user?.lastname}</td><td>${projectAccountLoop?.email}</td><td>${projectAccountLoop?.user?.username}</td>
												<td><font color="green">${message:yes-label}</font></td>
												<p:else>
													<td><t:checkbox t:id="idDisabledpp" t:value="selectedpp" disabled="true"/></td>
													<td>${projectAccountLoop?.name}</td><td>${projectAccountLoop?.label}</td><td>${projectAccountLoop?.user?.lastname}</td><td>${projectAccountLoop?.email}</td><td>${projectAccountLoop?.user?.username}</td>
													<td><font color="red">${message:no-label}</font></td>
												</p:else>
											</t:if>
										<!--  <td><t:checkbox t:id="idpp" t:value="selectedpp"/></td>         
										<td>${projectAccountLoop?.name}</td><td>${projectAccountLoop?.label}</td><td>${projectAccountLoop?.user?.lastname}</td><td>${projectAccountLoop?.email}</td><td>${projectAccountLoop?.user?.username}</td>	
	                				--></p>
								</tr>
	               			</t:loop>
		         		</t:if>
						
					</table>
					<br />
					</t:if>
				</t:if>
				<br />
				<t:accessibleCaptcha question="question" questionKey="questionKey" answer="answer" />
				
				<div class="form-actions">
					<p>
						<t:submit t:id="submit" value="message:submit-label" />
					</p>
				</div>
				
            </fieldset>
        </t:form>
	</div>
</html>